steps:
  - label: ":mag: Audit shared and mobile dependencies"
    command: "cd src/shared && yarn audit && cd ../mobile && yarn audit && cd ../.."
    agents:
      queue: dev
    plugins:
      docker#v1.4.0:
        image: "rajivshah/trinity-mobile-ci"
        always-pull: true

  - wait

  - label: ":eslint: Run ESLint for shared and mobile"
    command: "yarn lint:shared && yarn lint:mobile"
    agents:
      queue: dev
    plugins:
      docker#v1.4.0:
        image: "rajivshah/trinity-mobile-ci"
        always-pull: true

  - wait

  - label: ":jest: Run mobile tests"
    command: "cd src/mobile && yarn test"
    agents:
      queue: dev
    plugins:
      docker#v1.4.0:
        image: "rajivshah/trinity-mobile-ci"
        always-pull: true

  - wait

  - label: ":react: Bundle"
    command: "cd src/mobile && react-native bundle --entry-file index.android.js --platform android --bundle-output android/main.jsbundle --dev true"
    agents:
      queue: dev
    plugins:
      docker#v1.4.0:
        image: "rajivshah/trinity-mobile-ci"
        always-pull: true
